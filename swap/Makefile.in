CC=@CXX@
CXX=@CXX@
F77=@F77@
F77_LIBS=@F77_LIBS@

libext = @libext@
incs =  @ftlibincs@
libincs = @otherlibsinc@
libs = @otherlibs@ -lboost_system -ljvm
build_cpu = @build_cpu@
incsloc = -I. -I../include -I/usr/lib/jvm/java-7-openjdk-amd64/include -I/usr/lib/jvm/java-7-openjdk-amd64/include/linux
LFLAGS = -L/usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server

PETSC = yes
PETSC_ARCH=@PETSC_ARCH@
PETSC_DIR=@PETSC_DIR@


Petsc_Include=@PETSC_INCLUDE@ 
Petsc_Lib=@PETSC_LIB@ 

USEGPU = @USEGPU@

all : swap status record

swap : @devel@

sim.o : swap.h sim.cpp
	${CXX} -c sim.cpp $(incsloc) $(incs) ${Petsc_Include}
sub.o : swap.h sub.cpp
	${CXX} -c sub.cpp $(incsloc) $(incs) ${Petsc_Include}
web.o : swap.h web.cpp
	${CXX} -c web.cpp $(incsloc) $(incs) ${Petsc_Include}
trade.o : swap.h trade.cpp
	${CXX} -c trade.cpp $(incsloc) $(incs) ${Petsc_Include}
DG.class: DG.java
	javac -cp .:jsoup-1.8.3.jar DG.java

swap: swap.h swap.cpp sim.o sub.o web.o trade.o DG.class
	${CXX} -c swap.cpp $(incsloc) $(incs) ${Petsc_Include}
	$(CXX) -o swap swap.o sim.o sub.o web.o trade.o -I../include -L../lib/${build_cpu} ${Petsc_Lib} -L../lib/${build_cpu} -lFronTier $(libincs) $(LFLAGS) $(libs) ${F77_LIBS}

status: swap.h status.cpp sim.o sub.o web.o trade.o DG.class
	${CXX} -c status.cpp $(incsloc) $(incs) ${Petsc_Include}
	$(CXX) -o status status.o sim.o sub.o web.o trade.o -I../include -L../lib/${build_cpu} ${Petsc_Lib} -L../lib/${build_cpu} -lFronTier $(libincs) $(LFLAGS) $(libs) ${F77_LIBS}

record: swap.h record.cpp sim.o sub.o web.o trade.o DG.class
	${CXX} -c record.cpp $(incsloc) $(incs) ${Petsc_Include}
	$(CXX) -o record record.o sim.o sub.o web.o trade.o -I../include -L../lib/${build_cpu} ${Petsc_Lib} -L../lib/${build_cpu} -lFronTier $(libincs) $(LFLAGS) $(libs) ${F77_LIBS}

-include ../devel-deps.inc

clean:
	rm -rf *.o swap status record DG.class
output :
	rm -rf out/*

TagsFile:
	ctags *.cpp *.h ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]

tagsfile:
	ctags *.cpp *.h ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]

etagsfile:
	etags *.cpp *.h ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]
