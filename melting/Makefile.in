CXX=@CXX@
F77=@F77@
F77_LIBS=@F77_LIBS@

libext = @libext@
incs =  @ftlibincs@
libincs = @otherlibsinc@
libs = @otherlibs@
build_cpu = @build_cpu@
incsloc = -I. -I../iFluid -I../include

PETSC = yes
PETSC_ARCH=@PETSC_ARCH@
PETSC_DIR=@PETSC_DIR@

Petsc_Include=@PETSC_INCLUDE@
Petsc_Lib=@PETSC_LIB@

melting : @devel@

marray.o : melting.h melting_basic.h marray.cpp
	${CXX} -c marray.cpp $(incsloc) $(incs) ${Petsc_Include}

minit.o : melting.h melting_basic.h minit.cpp
	${CXX} -c minit.cpp $(incsloc) $(incs) ${Petsc_Include}

mprop.o : melting.h melting_basic.h mprop.cpp
	${CXX} -c mprop.cpp $(incsloc) $(incs) ${Petsc_Include}

mcartsn.o : melting.h melting_basic.h mcartsn.cpp
	${CXX} -c mcartsn.cpp $(incsloc) $(incs) ${Petsc_Include}

solver.o : ../iFluid/solver.h ../iFluid/solver.cpp
	${CXX} -c ../iFluid/solver.cpp $(incsloc) $(incs) ${Petsc_Include}

parab.o : ../iFluid/solver.h ../iFluid/parab.cpp
	${CXX} -c ../iFluid/parab.cpp $(incsloc) $(incs) ${Petsc_Include}

melting: melting.h melting_basic.h melting_basic.h melting.cpp marray.o minit.o solver.o mcartsn.o mprop.o parab.o
	${CXX} -c melting.cpp -I../include $(incs) ${Petsc_Include}
	$(CXX) -o melting melting.o -I../include -L../lib/${build_cpu}  solver.o mcartsn.o marray.o minit.o mprop.o parab.o ${Petsc_Lib} -L../lib/${build_cpu} -lFronTier $(libincs)  $(libs) ${F77_LIBS}

-include ../devel-deps.inc

clean:
	rm -rf *.o melting 
output :
	rm -rf out/*

gif :
	hdf2gif out/intfc.hdf out/intfc.gif

TagsFile:
	ctags *.h *.cpp ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]

tagsfile:
	ctags *.h *.cpp ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]

etagsfile:
	etags *.h *.cpp ../src/front/*.[ch] ../src/intfc/*.[ch] ../src/util/*.[ch]
